<html>
<head>
  <script src="libs/jquery-1.7.2.min.js"></script>
  <script src="plugins/jquery.DOMSource.js"></script>
</head>
<body>

<div class="element demo">
  <div class="car" data-color="red" data-make="ford" data-model="del rey">Red Ford Del Rey</div>
</div>

<div class="children demo">
    <div class="car">
      <span class="color">yellow</span>
      <span class="make">dodge</span>
      <span class="model">dart</span>
    </div>
</div>

<div class="list demo">
    <ul>
      <li>
        <span class="color">blue</span>
        <span class="make">amc</span>
        <span class="model">hornet</span>
      </li>
      <li>
        <span class="color">orange</span>
        <span class="make">chevrolet</span>
        <span class="model">corvair</span>
      </li>
    </ul>
</div>

<div class="table demo">
    <table>
      <thead>
        <tr>
          <th>Color</th>
          <th>Make</th>
          <th>Model</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>green</td>
          <td>oldsmobile</td>
          <td>woodie</td>
        </tr>
        <tr>
          <td>silver</td>
          <td>dmc</td>
          <td>delorean</td>
        </tr>
      </tbody>
    </table>
</div>

<script>

jQuery(document).ready(function ($) {

	var modelAttributes = {
		color: '',
		make: '',
		model: ''
	};

  $('.demo').each(function () {
		var type = this.className.match(/^\w+/)[0], 
			model = $(':first-child', this).DOMDataSource(modelAttributes, { type: type });

		$('<pre>' + JSON.stringify(model) + '</pre>').appendTo(this);
  });

});
</script>
</body>
</html>
